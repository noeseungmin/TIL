## Thymleaf

### 기본 표현식 
* 간단한 표현:
  * 변수 표현식: ${...}
  * 선택 변수 표현식: *{...}
  * 메시지 표현식: #{...}
  * 링크 URL 표현식: @{...}
  * 조각 표현식: ~{...}
* 리터럴
  * 텍스트: 'one text', 'Another one!',…
  * 숫자: 0, 34, 3.0, 12.3,…
  * 불린: true, false
  * 널: null
  * 리터럴 토큰: one, sometext, main,…
* 문자 연산:
  * 문자 합치기: +
  * 리터럴 대체: |The name is ${name}|
  * 산술 연산:
  * Binary operators: +, -, *, /, %
  * Minus sign (unary operator): -
* 불린 연산:
  * Binary operators: and, or
  * Boolean negation (unary operator): !, not
* 비교와 동등:
  * 비교: >, <, >=, <= (gt, lt, ge, le)
  * 동등 연산: ==, != (eq, ne)
* 조건 연산:
  * If-then: (if) ? (then)
  * If-then-else: (if) ? (then) : (else)
  * Default: (value) ?: (defaultvalue)
* 특별한 토큰:
  * No-Operation: _

### text, utext
#### th:text, [[...]]
```
  <li>th:text 사용 <span th:text="${data}"></span> </li>
  <li>컨텐츠 안에서 직접 출력하기 = [[${data}]]</li>
```
* th:text : 기본적인 HTML 태그의 속성은 타임리프가 사용 할 수 있다. HTML 태그 속성 앞에 th:만 붙여주면 타임리프를 사용할 수 있으며 
동적 HTML으로 랜더링시 th:속성으로 화면을 구성해준다.
* [[...]] : HTML태그의 속성이 아닌 HTML콘텐츠 영역 안에서 직접 데이터를 출력하는 방법
```
  <li>th:text 사용 <span>Hello Spring!</span></li>
  <li>컨텐츠 안에서 직접 출력하기 = Hello Spring!</li>
```
#### Escape
HTML 문서는 <,> 같은 특수 문자를 기반으로 정의 된다. 따라서 뷰 템플릿으로 HTML 화면 생성시 출력하는 데이터에 이러한 
특수 문자가 있는것을 주의해서 사용해야 한다.

`Hello <b>Spring!</b>` `<b>` 태그를 사용해서 Spring! 단어를 진하게

`<li>th:text = <span th:text="${data}"></span></li>`

`<li>th:text = <span>&lt;b&gt;Hello&lt;/b&gt;</span></li>`

`<b>`가 있으면 해당 부분을 강조하려 했으나 `<b>`태그가 그대로 나온다. <부분이 &lt로 변경된 것을 확인 할 수 있다.

웹 브라우저는 <를 HTML 테그의 시작으로 인식 따라서 <를 테그의 시작이 아닌 문자로 표현할 방법이 필요한데 이것을 HTML 엔티티라 한다.
HTML에서 사용하는 특수 문자를 HTML엔티티로 변경하는 것을 escape라 한다. 타임 리프가 제공하는 th:text, [[..]]는 기본적으로 escape를 제공한다.                                   
                                
#### Unescape                                   
`th:text` -> `th:utext`, [[...]] -> [(...)] 이스케이프 기능을 사용하지 않기 위해 두가지 기능 제공.                            
`<li>th:utext = <span th:utext="${data}"></span></li>`

`<li>th:utext = <span><b>Hello</b></span></li>`

* 실제 서비스를 개발하다 보면 escape를 사용하지 않아서 HTML이 정상 렌더링 되지 않는 수 많은 문제가 발생하기 떄문에 escape를 기본으로 하고 꼭 필요할때만 unescape를 사용

### SpringEL
#### Onject
`<span th:text="${user.username}"></span>` - user의 username 프로퍼티 접근(user.getUsername()) 

`<span th:text="${user['username']}"></span>` - 위와 동일(user.getUsername()) 

`<span th:text="${user.getUsername()}"></span>` - user의 getUsername(), getter 직접 호출

#### List
`<span th:text="${users[0].username}"></span>` - List에서 첫번째 회원을 찾고 username 프로퍼티 접근(list.get(0).getUsername())

`<span th:text="${users[0]['username']}"></span>` - 위와 동일

`<span th:text="${users[0].getUsername()}"></span>` - List에서 첫번째 회원을 찾고 메서드 직접 호출

#### Map
`<span th:text="${userMap['userA'].username}"></span>` - Map에서 userA라는 key 값의 username 프로퍼티 접근(map.get("userA").getUsername)

`<span th:text="${userMap['userA']['username']}"></span>` - 위와 동일

`<span th:text="${userMap['userA'].getUsername()}"></span>` - Map에서 userA라는 key값의 getter 직접 호출

#### 지역 변수 선언
`th:with`를 사용하면 지역 변수를 선언해서 사용할 수 있다. 지역 변수는 선언한 테그 안에서만 사용할 수 있다.
```
<div th:with="first=${users[0]}">
 <p>처음 사람의 이름은 <span th:text="${first.username}"></span></p>
</div>
```

### 기본 객체
`${#request}` - 스프링 부트 3.0부터 제공하지 않는다.
`${#response}` - 스프링 부트 3.0부터 제공하지 않는다.
`${#session}` - 스프링 부트 3.0부터 제공하지 않는다.
`${#servletContext}` - 스프링 부트 3.0부터 제공하지 않는다.
`${#locale}`

* 3.0 미만
```java
@GetMapping("/basic-objects")
public String basicObjects(HttpSession session) {
 session.setAttribute("sessionData", "Hello Session");
 return "basic/basic-objects";
}
@Component("helloBean")
static class HelloBean {
 public String hello(String data) {
 return "Hello " + data;
 }
```

* 3.0 이상
```java
@GetMapping("/basic-objects")
public String basicObjects(Model model, HttpServletRequest request,
HttpServletResponse response, HttpSession session) {
 session.setAttribute("sessionData", "Hello Session");
 model.addAttribute("request", request);
 model.addAttribute("response", response);
 model.addAttribute("servletContext", request.getServletContext());
 return "basic/basic-objects";
}
@Component("helloBean")
static class HelloBean {
 public String hello(String data) {
 return "Hello " + data;
 }
 ```
 
 ```java
 <li>request = <span th:text="${request}"></span></li>
 <li>response = <span th:text="${response}"></span></li>
 <li>session = <span th:text="${session}"></span></li>
 <li>servletContext = <span th:text="${servletContext}"></span></li>
 <li>locale = <span th:text="${#locale}"></span></li>
 ```
#request는 HttpServletRequest가 객체 그대로 제공되기 때문에 데이터를 조회하려면 `request.getParameter("data")`처럼 불편하게 접근해야 한다.
이런점을 해결하기 위해 편의 객체 제공

`${param.paramData}` - Http 요청 파라미터 접근
`${session.sessionData}` - HTTP 세션 접근
`${@helloBean.hello('Spring!')}` - 스프링 빈 접근


### URL 링크
#### Absolute URL
특정 url로 직접 이동이 가능
`<a th:href="@{http://www.thymeleaf/documentation.html}">`

#### Context-relative URL
가장 많이 사용되는 유형 서버 내 특정 위치로 이동이 가능하도록 하는 URL
`<a th:href="@{/oreder/list}">` 서버내 리소스 /order/list 호출

#### Adding Parameter URL
파라미터를 추가하는 방식의 URL
`<a th:href="@{/oreder/details(id=1)}">` https://www.test.io/order/details?id=1 파라미터 생성
